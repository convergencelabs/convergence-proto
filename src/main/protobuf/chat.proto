syntax = "proto3";

package io.convergence.proto;

import "google/protobuf/wrappers.proto";
import "google/protobuf/timestamp.proto";
import "common.proto";
import "scalapb/scalapb.proto";

message ChatChannelMemberData {
  string username = 1;
  int64 maxSeenEventNumber = 2;
}

message PublishChatRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  string message = 2;
}

message PublishChatResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";
}

message RemoteChatMessageMessage {
  option (scalapb.message).extends = "io.convergence.proto.Normal";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string sessionId = 4;
  string message = 5;
}

message CreateChatChannelRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  google.protobuf.StringValue channelId = 1;
  string channelType = 2;
  string channelMembership = 3;
  string name = 4;
  string topic = 5;
  repeated string members = 6;
}

message CreateChatChannelResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
}

message RemoveChatChannelRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
}

message RemoveChatChannelResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";
}

message ChatChannelRemovedMessage {
  option (scalapb.message).extends = "io.convergence.proto.Normal";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
}

message JoinChatChannelRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
}

message ChatChannelInfoData {
  string id = 1;
  string channelType = 2;
  string membership = 3;
  string name = 4;
  string topic = 5;
  google.protobuf.Timestamp createdTime = 6;
  google.protobuf.Timestamp lastEventTime = 7;
  int64 lastEventNumber = 8;
  repeated ChatChannelMemberData members = 9;
}

message JoinChatChannelResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  ChatChannelInfoData channelInfo = 1;
}

message UserJoinedChatChannelMessage {
  option (scalapb.message).extends = "io.convergence.proto.Normal";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
}

message AddUserToChatChannelRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  string userToAdd = 2;
}

message AddUserToChatChannelResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";
}

message UserAddedToChatChannelMessage {
  option (scalapb.message).extends = "io.convergence.proto.Normal";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
  string addedUser = 5;
}

message ChatChannelJoinedMessage {
  option (scalapb.message).extends = "io.convergence.proto.Normal";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
}

message LeaveChatChannelRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
}

message LeaveChatChannelResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";
}

message UserLeftChatChannelMessage {
  option (scalapb.message).extends = "io.convergence.proto.Normal";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
}

message RemoveUserFromChatChannelRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  string userToRemove = 2;
}

message RemoveUserFromChatChannelResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";
}

message UserRemovedFromChatChannelMessage {
  option (scalapb.message).extends = "io.convergence.proto.Normal";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
  string removedUser = 5;
}

message ChatChannelLeftMessage {
  option (scalapb.message).extends = "io.convergence.proto.Normal";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
}

message SetChatChannelNameRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  string name = 2;
}

message SetChatChannelNameResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";
}

message ChatChannelNameSetMessage {
  option (scalapb.message).extends = "io.convergence.proto.Normal";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
  string name = 5;
}

message SetChatChannelTopicRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  string topic = 2;
}

message SetChatChannelTopicResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";
}

message ChatChannelTopicSetMessage {
  option (scalapb.message).extends = "io.convergence.proto.Normal";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
  string topic = 5;
}

message MarkChatChannelEventsSeenRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  int64 eventNumber = 2;
}

message MarkChatChannelEventsSeenResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";
}

message ChatChannelEventsMarkedSeenMessage {
  option (scalapb.message).extends = "io.convergence.proto.Normal";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  string username = 2;
  int64 eventNumber = 3;
}

// history
message GetJoinedChatChannelsRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";
}

message GetJoinedChatChannelsResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  repeated ChatChannelInfoData channelInfo = 1;
}

message GetChatChannelsRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  repeated string channelIds = 1;
}

message GetChatChannelsResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  repeated ChatChannelInfoData channelInfo = 1;
}

message GetDirectChannelsRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  repeated StringList usernameLists = 1;
}

message GetDirectChannelsResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  repeated ChatChannelInfoData channelInfo = 1;
}

message ChatChannelHistoryRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  string channelId = 1;
  google.protobuf.Int32Value limit = 2;
  google.protobuf.Int64Value startEvent = 3;
  google.protobuf.BoolValue forward = 4;
  repeated string eventFilter = 5;
}

message ChatChannelHistoryResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  repeated ChatChannelEventData eventData = 1;
}

message ChatChannelsExistsRequestMessage {
  option (scalapb.message).extends = "io.convergence.proto.Request";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  repeated string channelIds = 1;
}

message ChatChannelsExistsResponseMessage {
  option (scalapb.message).extends = "io.convergence.proto.Response";
  option (scalapb.message).extends = "io.convergence.proto.Chat";

  repeated bool exists = 1;
}

message ChatCreatedEventData {
  string channel = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
  string name = 5;
  string topic = 6;
  repeated string members = 7;
}

message ChatMessageEventData {
  string channel = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
  string message = 5;
}

message ChatUserJoinedEventData {
  string channel = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
}

message ChatUserLeftEventData {
  string channel = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
}

message ChatUserAddedEventData {
  string channel = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string addedUser = 4;
  string username = 5;
}

message ChatUserRemovedEventData {
  string channel = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string removedUser = 4;
  string username = 5;
}

message ChatNameChangedEventData {
  string channel = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
  string name = 5;
}

message ChatTopicChangedEventData {
  string channel = 1;
  int64 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
  string topic = 5;
}

message ChatChannelEventData {
  oneof event {
    ChatCreatedEventData created = 1;
    ChatMessageEventData message = 2;
    ChatUserJoinedEventData userJoined = 3;
    ChatUserLeftEventData userLeft = 4;
    ChatUserAddedEventData userAdded = 5;
    ChatUserRemovedEventData userRemoved = 6;
    ChatNameChangedEventData nameChanged = 7;
    ChatTopicChangedEventData topicChanged = 8;
  }
}
