syntax = "proto3";

package com.convergencelabs.protocol;

import "google/protobuf/timestamp.proto";
import "authentication.proto";
import "scalapb/scalapb.proto";

message PublishChatRequestMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Request";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  string message = 2;
}

message PublishChatResponseMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Response";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";
}

message RemoteChatMessageMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Outgoing";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  int32 eventNo = 2;
  google.protobuf.Timestamp timestamp = 3;
  SessionKey session = 4;
  string message = 5;
}

message CreateChatChannelRequestMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Request";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  string channelType = 2;
  string name = 3;
  string topic = 4;
  string privateChannel = 5;
  repeated string members = 6;
}

message CreateChatChannelResponseMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Response";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
}

message RemoveChatChannelRequestMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Request";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
}

message RemoveChatChannelResponseMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Response";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";
}

message ChatChannelRemovedMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Outgoing";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
}

message JoinChatChannelRequestMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Request";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
}

message ChatChannelInfoData {
  string id = 1;
  string channelType = 2;
  string membership = 3;
  string name = 4;
  string topic = 5;
  google.protobuf.Timestamp createdTime = 6;
  google.protobuf.Timestamp lastEventTime = 7;
  int32 lastEventNo = 8;
  repeated string members = 9;
}

message JoinChatChannelResponseMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Response";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  ChatChannelInfoData channelInfo = 1;
}

message UserJoinedChatChannelMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Outgoing";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  int32 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
}

message AddUserToChatChannelRequestMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Request";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  string userToAdd = 2;
}

message AddUserToChatChannelResponseMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Response";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";
}

message UserAddedToChatChannelMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Outgoing";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  int32 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
  string addedBy = 5;
}

message ChatChannelJoinedMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Outgoing";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
}

message LeaveChatChannelRequestMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Request";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
}

message LeaveChatChannelResponseMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Response";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";
}

message UserLeftChatChannelMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Outgoing";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  int32 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
}

message RemoveUserFromChatChannelRequestMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Request";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  string userToRemove = 2;
}

message RemoveUserFromChatChannelResponseMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Response";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";
}

message UserRemovedFromChatChannelMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Outgoing";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  int32 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string username = 4;
  string removedBy = 5;
}

message ChatChannelLeftMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Outgoing";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
}

message SetChatChannelNameRequestMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Request";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  string name = 2;
}

message SetChatChannelNameResponseMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Response";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";
}

message ChatChannelNameSetMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Outgoing";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  int32 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string setBy = 4;
  string name = 5;
}

message SetChatChannelTopicRequestMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Request";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  string topic = 2;
}

message SetChatChannelTopicResponseMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Response";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";
}

message ChatChannelTopicSetMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Outgoing";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  int32 eventNumber = 2;
  google.protobuf.Timestamp timestamp = 3;
  string setBy = 4;
  string topic = 5;
}

message MarkChatChannelEventsSeenRequestMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Request";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  int32 eventNumber = 2;
}

message MarkChatChannelEventsSeenResponseMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Response";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";
}

message ChatChannelEventsMarkedSeenMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Outgoing";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  int32 eventNumber = 2;
}

// history
message GetJoinedChatChannelsRequestMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Request";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";
}

message GetJoinedChatChannelsResponseMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Response";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  repeated ChatChannelInfoData chatChannelInfo = 1;
}

message GetChatChannelsRequestMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Request";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  repeated string ids = 1;
}

message GetChatChannelsResponseMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Response";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  repeated ChatChannelInfoData chatChannelInfo = 1;
}

message GetDirectChannelsRequestMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Request";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  repeated string usernames = 1;
}

message GetDirectChannelsResponseMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Response";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  repeated ChatChannelInfoData chatChannelInfo = 1;
}

message ChatChannelHistoryRequestMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Request";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  string channelId = 1;
  int32 limit = 2;
  int32 offset = 3;
  bool forward = 4;
  repeated int32 eventFilter = 5;
}

message ChatChannelHistoryResponseMessage {
  option (scalapb.message).extends = "com.convergencelabs.protocol.Response";
  option (scalapb.message).extends = "com.convergencelabs.protocol.Chat";

  repeated ChatChannelInfoData eventData = 1;
}

message ChatCreatedEventData {
  string channel = 1;
  int32 eventNo = 2;
  google.protobuf.Timestamp timestamp = 3;
  string user = 4;
  string name = 5;
  string topic = 6;
  repeated string members = 7;
}

message ChatMessageEventData {
  string channel = 1;
  int32 eventNo = 2;
  google.protobuf.Timestamp timestamp = 3;
  string user = 4;
  string message = 5;
}

message ChatUserJoinedEventData {
  string channel = 1;
  int32 eventNo = 2;
  google.protobuf.Timestamp timestamp = 3;
  string user = 4;
}

message ChatUserLeftEventData {
  string channel = 1;
  int32 eventNo = 2;
  google.protobuf.Timestamp timestamp = 3;
  string user = 4;
}

message ChatUserAddedEventData {
  string channel = 1;
  int32 eventNo = 2;
  google.protobuf.Timestamp timestamp = 3;
  string addedUser = 4;
  string user = 5;
}

message ChatUserRemovedEventData {
  string channel = 1;
  int32 eventNo = 2;
  google.protobuf.Timestamp timestamp = 3;
  string removedUser = 4;
  string user = 5;
}

message ChatNameChangedEventData {
  string channel = 1;
  int32 eventNo = 2;
  google.protobuf.Timestamp timestamp = 3;
  string user = 4;
  string name = 5;
}

message ChatTopicChangedEventData {
  string channel = 1;
  int32 eventNo = 2;
  google.protobuf.Timestamp timestamp = 3;
  string user = 4;
  string topic = 5;
}

message ChatChannelEventData {
  oneof event {
    ChatCreatedEventData created = 1;
    ChatMessageEventData message = 2;
    ChatUserJoinedEventData userJoined = 3;
    ChatUserLeftEventData userLeft = 4;
    ChatUserAddedEventData userAdded = 5;
    ChatUserRemovedEventData userRemoved = 6;
    ChatNameChangedEventData nameChanged = 7;
    ChatTopicChangedEventData topicChanged = 8;
  }
}
